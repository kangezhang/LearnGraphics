# 图形学可视化工具

下面给你一条\*\*“可扩展 Three.js 可视化知识库”\*\*的开发路径，目标是：你以后每增加一个新知识点（向量、矩阵、相机、投影、光照几何、射线等），都像“加一个插件/章节”一样，不用改核心框架。

我按**架构 → 目录结构 → 关键模块 → 迭代里程碑**给你一套可落地方案（不要求你写 shader）。

* * *

1) 你这个项目的“正确抽象”
---------------

把每个知识点当成一个 **Lesson（课程/演示模块）**：

*   Lesson 有自己的：场景内容、交互、参数面板、说明文档、可选的步骤动画
*   框架负责：渲染循环、资源管理、UI 外壳、路由、热加载、录制/截图、统一 Debug

一句话：**核心是“Lesson 插件化 + 数据驱动目录”**。

* * *

2) 推荐技术栈
--------

*   Three.js（渲染与对象）
*   Vite（开发体验/构建快）
*   TypeScript（保证可扩展与接口稳定）
*   UI：建议用原生 DOM / 简单组件（避免 UI 过重）；参数面板用轻量方案（自写或小库都行）
*   内容：Markdown（每个 Lesson 带一份讲解文档）

> 你要求“不断加新知识”，TS + 插件接口会让后期维护成本最低。

* * *

3) 目录结构（关键）
-----------

建议这样组织（你以后新增内容只需新增一个文件夹）：

```
src/
  app/                     // 框架壳
    main.ts
    router.ts              // 路由：/lesson/:id
    shell/                 // UI外壳：左侧目录 + 中间画布 + 右侧说明/参数
  core/                    // 引擎核心（稳定、不轻易改）
    renderer/              // three renderer + render loop + resize
    scene-host/            // lesson mount/unmount
    input/                 // 鼠标/触摸/键盘统一输入
    camera/                // 轨道相机/第一人称相机封装
    assets/                // 纹理/模型加载与缓存
    gizmos/                // 坐标轴、网格、箭头、法线、视锥、射线等“教学可视化组件”
    debug/                 // stats、log overlay、helper toggles
    state/                 // 全局状态（当前lesson、参数、UI布局）
  lessons/                 // 课程库（不断增长）
    index.ts               // 自动注册/清单（可做成自动扫描）
    vector-dot/            // 一个知识点一个目录
      lesson.ts            // 实现 Iकार्य：setup/update/dispose
      doc.md               // 讲解
      config.json          // 元信息：标题、标签、难度、默认参数
    camera-frustum/
      lesson.ts
      doc.md
      config.json
  content/
    glossary.md            // 术语表（可选）
```

核心思想：**core 稳定，lessons 无限扩展**。

* * *

4) Lesson 插件接口（你扩展能力的根）
-----------------------

每个 Lesson 实现一个统一接口（概念上这样）：

*   `meta`：标题/标签/难度/需要的 gizmos
*   `setup(ctx)`：创建对象、注册 UI 参数、注册输入事件
*   `update(dt)`：每帧更新（动画/步骤）
*   `dispose()`：清理资源与事件（必须）

ctx（上下文）由框架提供：

*   three scene、camera、renderer
*   gizmo 工厂（画向量箭头/平面/射线/视锥）
*   ui API（注册参数、按钮、步骤条）
*   input API（拖拽、点击拾取、快捷键）
*   timeline API（可选：步骤演示）

这样你后面写新内容时，不碰框架，只写 Lesson。

* * *

5) “教学可视化组件库”是你最值钱的资产
---------------------

你这个项目的复用点不是渲染，而是这些 **Gizmos**（强烈建议优先做）：

*   坐标轴/网格（WorldGrid）
*   Arrow（向量箭头：起点、方向、长度、颜色、文字标签）
*   Plane（平面：法线箭头、方程展示）
*   Ray（射线：起点、方向、与物体/平面交点标记）
*   Frustum（相机视锥：near/far/FOV 可视化）
*   Points/Labels（点的标签、坐标显示）
*   Measure（距离、角度弧线、投影线段）
*   Trajectory（轨迹线：比如插值、旋转、曲线）

有了这套 Gizmos，你后面的“新知识”基本就是：

> 摆几个 Gizmo + 做几个交互 + 写 doc

* * *

6) UI 外壳与交互模式
-------------

建议固定一个“学习 UI 模式”，越统一越省心：

*   左侧：课程树（按标签：线代/相机/几何/空间变换/光照几何…）
*   中间：Canvas（three）
*   右侧：两页签
    *   “说明”：渲染 Markdown（带公式可以后面加）
    *   “参数”：滑条/开关/按钮/步骤条（Step 1/2/3）

统一交互约定：

*   鼠标左键：拖动对象/点（若 lesson 开启拾取）
*   右键或双指：旋转相机
*   滚轮：缩放
*   快捷键：R 重置、G 开关网格、H 开关辅助线

* * *

7) 资源与性能的“框架级规范”
----------------

为了你长期可维护，早期就立规矩：

*   Lesson 必须实现 dispose：释放 geometry/material、remove event listener
*   统一资源缓存：同一纹理/模型不重复加载
*   统一 resize：渲染器、相机 aspect、dpr 策略
*   统一拾取：封装 Raycaster + layer 规则（避免 Lesson 各写一套）

* * *

8) 开发里程碑（建议按这个顺序做）
------------------

### Milestone A：骨架跑起来（1 个 demo）

*   Vite + TS + Three.js 基础渲染
*   Shell：左侧目录 + 中间画布 + 右侧说明/参数（先写死）
*   Lesson Host：切换 lesson 能 mount/unmount
*   做一个 Lesson：`vector-dot`（点积可视化：两箭头 + 角度 + 数值）

交付标准：**新增 lesson 只需复制模板文件夹即可运行**

### Milestone B：Gizmos 库成型（复用开始）

*   Arrow、Label、MeasureAngle、Ray、Plane
*   统一 picking（拖拽点/箭头端点）
*   统一 UI 参数 API（registerSlider/registerToggle/registerButton）

交付标准：**做第二个/第三个 lesson 时，80% 不写 three 原生细节**

### Milestone C：课程系统（内容规模化）

*   lessons/index 自动注册（或自动扫描）
*   config.json 驱动：标题/标签/排序/默认参数
*   搜索、标签过滤、收藏（可选）

交付标准：**100 个 lesson 目录仍然清爽可管理**

### Milestone D：教学增强（体验拉满）

*   Step/Tutorial：步骤条（Step 1/2/3），每步自动摆状态
*   截图/录屏（至少截图）
*   状态分享：把当前参数 encode 到 URL（可选，非常好用）

交付标准：**你能把一个知识点做成“可演示课件”**

* * *

9) 你下一步该先做哪三个 Lesson
--------------------

为了让框架马上验证价值，我建议从“高复用、能覆盖很多后续知识”的三节开始：

1.  **向量与点积**
    *   两向量箭头、角度弧线、点积数值、投影线段（Measure 组件会复用爆炸）
    2.  **相机视锥与投影**
    *   可视化 frustum、near/far、FOV 改变
*   一个点从世界到屏幕坐标的过程（后面所有屏幕空间算法都用得到）
    3.  **射线与相交**
    *   Ray–Plane、Ray–Triangle
*   拖动射线方向/平面，实时显示交点与参数 t（后面 Ray Marching/拾取/碰撞都能复用）

